"use strict";function _classCallCheck(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function i(i,t){for(var e=0;e<t.length;e++){var a=t[e];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(i,a.key,a)}}return function(t,e,a){return e&&i(t.prototype,e),a&&i(t,a),t}}(),SummaryBehaviorDetail=function(){function i(t,e,a,s,l){_classCallCheck(this,i),this.task_id=t,this.pname=e,this.pid=a,this.category=s,this.val=l,this.limit=5,this.offset=0,this._setup=!1,this._sel=$("section#summary div#summary_"+this.category)}return _createClass(i,[{key:"start",value:function(i,t){var e={task_id:this.task_id,pid:this.pid,watcher:this.val,pname:this.pname};null!=i?e.offset=i:e.offset=this.offset,null!=t?e.limit=t:e.limit=this.limit;var a=this;CuckooWeb.api_post("/analysis/api/task/behavior_get_watcher/",e,function(i){a.start_cb(i,a)})}},{key:"_setup_html",value:function(i){var t='\n            <li id="cat_'+i.val+'" class="list-group-item">\n                <p><b>'+i.val+'</b></p>\n                <ul id="'+i.val+'"></ul>\n                <p class="btn_action">\n                    <span class="load_more">Load more</span> | <span class="load_all">Load all</span>\n                </p>\n            </li>';i._sel.find("ul#"+i.pid).append(t),i._sel.find("ul#"+i.pid+" #cat_"+i.val+" .btn_action .load_more").click(function(){i.more()}),i._sel.find("ul#"+i.pid+" #cat_"+i.val+" .btn_action .load_all").click(function(){i.all()}),i._setup=!0}},{key:"start_cb",value:function(i,t){t._setup||t._setup_html(t);var e=t._sel.find("ul#"+t.pid+" #cat_"+t.val);i.data.length<t.limit&&0!=t.offset?e.find(".btn_action").html('<span class="no_results">No more results...</span>'):i.data.length<t.limit&&0==t.offset&&e.find(".btn_action").hide();var a="";i.data.forEach(function(i,t){a+="<li>"+i+"</li>"}),e.find("ul#"+t.val).append(a)}},{key:"more",value:function(){this.offset+=this.limit,this.start()}},{key:"all",value:function(){i.clear_list(this),i.clear_ctrl_btns(this),this.start(0,0)}}],[{key:"clear_list",value:function(i){i._sel.find("ul#"+i.pid+" #cat_"+i.val+" ul#"+i.val).html("")}},{key:"clear_ctrl_btns",value:function(i){i._sel.find("ul#"+i.pid+" #cat_"+i.val+" .btn_action").hide()}}]),i}(),SummaryBehaviorController=function(){function i(t,e,a){_classCallCheck(this,i),this.task_id=t,this.pname=e,this.pid=a,this.loading=!1,this.loader=new Loader($(".loading")),this.behavioral_details=[]}return _createClass(i,[{key:"start",value:function(){var i={task_id:this.task_id,pid:this.pid},t=this;CuckooWeb.api_post("/analysis/api/task/behavior_get_watchers/",i,function(i){t.start_cb(i,t)})}},{key:"start_cb",value:function(i,t){$.each(i.data,function(i,e){var a=i,s=$("div#summary_"+a);s.append('\n                <div class="panel panel-default">\n                    <div class="panel-heading"><h3 class="panel-title">'+t.pname+" <small>pid: "+t.pid+'</small></h3></div>\n                    <ul id="'+t.pid+'" class="list-group">\n                    </ul>\n                </div>'),$.each(e,function(i,e){var s=new SummaryBehaviorDetail(t.task_id,t.pname,t.pid,a,e);s.start(),t.behavioral_details.push(s)})})}}],[{key:"toggle_loading",value:function(){this.loader.toggle()}}]),i}(),SummarySimplifier=function(){function i(t){return _classCallCheck(this,i),this.el=t,this._simplified=!1,this._keepQuery="keep",this._hideQuery="hide",this._callbacks={on:[],off:[]},this.initialise()}return _createClass(i,[{key:"initialise",value:function(){var i=this;return this.el.on("click",function(t){t.preventDefault(),i.toggle()}),"true"===$("body").attr("data-simplified")?(this._simplified=!0,this._update()):(this._simplified=!1,this._update()),this}},{key:"toggle",value:function(){this._simplified?this._off():this._on(),this._save()}},{key:"_off",value:function(){this._simplified=!1,this._update()}},{key:"_on",value:function(){this._simplified=!0,this._update();for(var i in this._callbacks.on)this._callbacks.on[i]()}},{key:"_update",value:function(i){this._simplified?(this.el.addClass("active"),this.el.find("span").text("default overview"),$("body").attr("data-simplified","true")):(this.el.removeClass("active"),this.el.find("span").text("simplify overview"),$("body").attr("data-simplified","false"))}},{key:"_save",value:function(){Cookies("simplified_view",this._simplified,{expires:3650})}},{key:"listen",value:function(i,t){this._callbacks[i].push(t)}}]),i}();$(function(){var i;if($("#toggle-simplified").length&&(i=window.simplifier=new SummarySimplifier($("#toggle-simplified"))),window.pewpew&&"function"==typeof window.pewpew)if(i){if(!i._simplified)return void i.listen("on",function(){window.pewpew()});window.pewpew()}else window.pewpew()});
//# sourceMappingURL=analysis_behavior.js.map
