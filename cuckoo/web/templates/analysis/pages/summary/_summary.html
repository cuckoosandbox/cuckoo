<style>
section .nav>li>a {
    position: relative;
    display: block;
    padding: 8px 15px;
}
</style>

<section id="summary">
    <h4><span class="glyphicon glyphicon-list-alt" aria-hidden="true"></span> Summary</h4>
    <div class="tabbable tabs">
        <ul class="nav nav-pills" style="margin-bottom: 0;">
            <li class="active"><a href="#summary_files" data-toggle="tab">Files</a></li>
            <li><a href="#summary_registry" data-toggle="tab">Registry</a></li>
            <li><a href="#summary_mutexes" data-toggle="tab">Mutexes</a></li>
            <li><a href="#summary_directories" data-toggle="tab">Directories</a></li>
            <li><a href="#summary_processes" data-toggle="tab">Processes</a></li>
        </ul>

        <script src="/static/js/cuckoo/analysis_behavior.js"></script>
        <script>
            var task_id = {{report.analysis.info.id}};
            var behaviors = [];

            //TODO: move to CuckooWeb js api
            $(document).ready(function(){
                CuckooWeb.api_post("/analysis/api/task/behavior_get_processes/", {"task_id": task_id}, function(data){
                    data.data.data.forEach(function(obj, i){
                        var behavior = new SummaryBehaviorController(
                                task_id,
                                obj["process_name"], obj["pid"]);

                        behavior.start();
                        behaviors.push(behavior);
                    });
                });
            });
        </script>
        <style>
            .tab-behaviour_summary .btn_action{
                font-size: 12px;
                margin-top: 14px;
            }

            .tab-behaviour_summary .btn_action .load_more, #tab_summary_watchers .btn_action .load_all{
                color: #337ab7;
                text-decoration: none;
                cursor: pointer;
            }

            .tab-behaviour_summary ul li ul li{
                padding: 2px;
            }
        </style>

        <div id="tab_summary_watchers" class="tab-content tab-behaviour_summary">
            <div class="tab-pane fade in active" id="summary_files"></div>
            <div class="tab-pane fade" id="summary_registry"></div>
            <div class="tab-pane fade" id="summary_mutexes"></div>
            <div class="tab-pane fade" id="summary_directories"></div>
            <div class="tab-pane fade" id="summary_processes"></div>
        </div>
    </div>
</section>
