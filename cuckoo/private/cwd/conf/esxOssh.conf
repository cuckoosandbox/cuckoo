[esxOssh]

# Specify which ESXI Host you will run your machines on.
host = {{ esxOssh.esxOssh.host }}

# Specify group Name of Virtual  machines on ESXi Host (especially necessary if you have not only Zombie VM's on it).
# Its actualy only a grep of this value on the LABEL so you have to give every Machine this Group Name as Part of its LABEL/VMNAME accordingly
vmgroup = {{ esxOssh.esxOssh.vmgroup }}

# Specify which ESXI Host you will run your machines on.
username = {{ esxOssh.esxOssh.username }}

# Specify which ESXI Host you will run your machines on.
password = {{ esxOssh.esxOssh.password }}

# Default network interface.
interface = {{ esxOssh.esxOssh.interface }}

# Specify a comma-separated list of available machines to be used. For each
# specified ID you have to define a dedicated section containing the details
# on the respective machine. (E.g. cuckoo1,cuckoo2,cuckoo3)
machines = {{ esxOssh.esxOssh.machines }}

{% for machine in config("esxOssh:esxOssh:machines") %}
[{{ machine }}]
# Specify the label name of the current machine as specified in your
# ESXi configuration.
label = {{ esxOssh[machine].label }}

# Specify the operating system platform used by current machine
# [windows/darwin/linux].
platform = {{ esxOssh[machine].platform }}

# Specify the IP address of the current virtual machine. Make sure that the
# IP address is valid and that the host machine is able to reach it. If not,
# the analysis will fail.
ip = {{ esxOssh[machine].ip }}

# (Optional) Specify the snapshot name to use. If you do not specify a snapshot
# name, the ESXI MachineManager will use the current snapshot.
# Example (Snapshot1 is the snapshot name):
snapshot = {{ esxOssh[machine].snapshot }}

# (Optional) Specify the name of the network interface that should be used
# when dumping network traffic from this machine with tcpdump. If specified,
# overrides the default interface specified in auxiliary.conf
# Example (eth0 is the interface name):
interface = {{ esxOssh[machine].interface }}

# (Optional) Specify the IP of the Result Server, as your virtual machine sees it.
# The Result Server will always bind to the address and port specified in cuckoo.conf,
# however you could set up your virtual network to use NAT/PAT, so you can specify here
# the IP address for the Result Server as your machine sees it. If you don't specify an
# address here, the machine will use the default value from cuckoo.conf.
# NOTE: if you set this option you have to set result server IP to 0.0.0.0 in cuckoo.conf.
# Example:
resultserver_ip = {{ esxOssh[machine].resultserver_ip }}

# (Optional) Specify the port for the Result Server, as your virtual machine sees it.
# The Result Server will always bind to the address and port specified in cuckoo.conf,
# however you could set up your virtual network to use NAT/PAT, so you can specify here
# the port for the Result Server as your machine sees it. If you don't specify a port
# here, the machine will use the default value from cuckoo.conf.
# Example:
resultserver_port = {{ esxOssh[machine].resultserver_port }}

# (Optional) Set your own tags. These are comma separated and help to identify
# specific VMs. You can run samples on VMs with tag you require.
tags = {{ esxOssh[machine].tags }}

# Mostly unused for now. Please don't fill it out.
options = {{ esxOssh[machine].options }}

# (Optional) Specify the OS profile to be used by volatility for this
# virtual machine. This will override the guest_profile variable in
# memory.conf which solves the problem of having multiple types of VMs
# and properly determining which profile to use.
osprofile = {{ esxOssh[machine].osprofile }}
{% endfor %}

[honeyd]
# For more information on this VM please refer to the "services" section of
# the conf/auxiliary.conf configuration file. This machine is a bit special
# in the way that its used as an additional VM for an analysis.
# *NOTE* that if this functionality is used, the VM should be registered in
# the "machines" list in the beginning of this file.
label = honeyd
platform = linux
ip = 192.168.56.102
# The tags should at least contain "service" and the name of this service.
# This way the services auxiliary module knows how to find this particular VM.
tags = service, honeyd
# Not all services actually have a Cuckoo Agent running in the VM, for those
# services one can specify the "noagent" option so Cuckoo will just wait until
# the end of the analysis instead of trying to connect to the non-existing
# Cuckoo Agent. We can't really intercept any inter-VM communication from the
# host / gateway so in order to dump traffic between VMs we have to use a
# different network dumping approach. For this machine we use the "nictrace"
# functionality from VirtualBox (which is basically their internal tcpdump)
# and thus properly dumps inter-VM traffic.
options = nictrace noagent
